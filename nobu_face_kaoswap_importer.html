<div class="content-box mb-3 content-lighten">
    <h2><i class="fa fa-file-image-o fa-fw"></i>多数の減色済みの顔グラを一括でkaoswap.n6pへと取り込む</h2>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>概要</h3>
    <p>多数の減色済みの顔グラフィックを一括でkaoswap.n6pへと取り込めるツールの提供、<br>
        及び、使用方法の解説となります。</p>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>ダウンロード</h3>
    <div class="card mb-3 ml-3" style="max-width: 30rem;">
        <!-- カード本文：card-body -->
        <div class="card-body text-center">
            <div class="row">
                <div class="col-12"><small>更新日 %(year)04d/%(mon)02d/%(mday)02d</small></div>
            </div>
            <a href="%(file)s" class="btn btn-primary"><i class="fa fa-download fa-fw"></i>KaoSwapFaceImporter.zip</a>
        </div>
    </div>
    <div class="card mb-3 ml-3" style="max-width: 30rem;">
        <!-- カード本文：card-body -->
        <div class="card-body text-center">
            <div class="row">
                <div class="col-12"><small>(ソースファイル)</small></div>
            </div>
            <a href="./cnt_mod/mod_tools/KaoswapFaceImporter.src.zip" class="btn btn-primary"><i class="fa fa-download fa-fw"></i>KaoSwapFaceImporter.src.zip</a>
            <div class="row">
                <div class="col-12"><small>(プログラム書ける人用)</small></div>
            </div>
        </div>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>説明</h3>

    <p>このツールは、0001.bmp～1332.bmpなど連番となっている８色の顔グラを、Kaoswap.n6pへと取り込むツールです。<br>
        このツールの<b>｢KaoSwapFaceImporter.exe｣自体は、天翔記フォルダ</b>に置き、<b>ご自分で用意した、Kaoswapへと取り込みたい顔画像(８色の連番画像)は｢kao_3bit｣というディレクトリに起きます</b>。<br>
        <br>
        <img src="./cnt_mod/cnt_face_kaoswapfaceimport.png"> <br></p>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>使い方</h3>
    <p>
        ・Kaoswap.n6pへと取り込みたい顔画像は｢kao_3bit｣ディレクトリに置く。<br>
        ・KaoSwapFaceImporterを実行する<br>
        (※顔画像は0001.bmp～1332.bmp)<br>
        <br></p>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>主なエラー</h3>
    <p>主に起きるのは２つのエラーです。エラーが起きるとエラーを表示した状態で止まります。</p>
    <ul>
        <li><b>ErrUsedColorPaletteOutOfRange</b><br>
            └画像内容の<b>パレット</b>の使用が９色目以上を指定している。<br>
            極めて高確率で256色やフルカラーになっている。もしくは8色ではなく、16色を使って画像を描いている。
        <li><b>ErrWrongWidthHeightPixel</b><br>
            └<b>64x80</b>の画像になっていない。<br>
    </ul>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>動作説明</h3>
    <ul class="pointlist">
        <li>
            <h4>このツールが実行すること。</h4>
            <p>
                このツールをちゃんと使うには、このツールが行うことを正しく理解する必要があります。<br>
                <br>
                (※このツールの実行速度はとても速く、一瞬黒い窓が出るだけで全ての処理が終わります。<br>
                ある程度のPCであれば、0.5～2秒ほどの間に2000個程度の顔画像の取り込みを完了してしまいますので、途中経過は目視して判断することは出来ません。)<br>
            </p>
        <li>
            <h4>KaoSwapFaceImporter.exeが実行されると自動処理する内容</h4>
            <ul>
                <li>Kaoswap.n6pから情報を取り込む。<br>
                    └kaoswap.n6pが存在しないという場合、事前情報は無いものと考える。<br>
                    (└即ち全ての顔は真っ白だ、という前提となる)
                <li>kao_3bitディレクトリ内にある、｢xxxx.bmp｣(xxxxは4桁の数字で0001以上～1332以下) に該当する.bmpファイルがあれば、<br>
                    これをKaoswap.n6pへと取り込む。<br>
                <li>逆に言えば、欠番となっている｢xxxx.bmp｣は、存在しないのであるから、該当の武将の顔画像は｢更新しない=現状維持｣とされる。
                <li>最後に元のkaoswap.n6pを書き換える。
            </ul>
            <p>以上です。 <br></p>
    </ul>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>備考</h3>
    <ul class="pointlist">
        <li>
            <h4>１個だけの顔グラでも、1332全部の顔グラでも、どちらでも大丈夫</h4>
            <p>全ての連番ファイルがそろっている必要は<b>ありません。</b> <br>
                番号が歯抜けになっていても大丈夫ですし、<br>
                たった１つだけの顔画像(例:0003.bmpだけ)などがあってもＯＫです。</p>
            <p>
                kao_3bitフォルダ内にある｢xxxx.bmp｣という命名規則に沿った画像は全てKaoswapへの取り込み対象となります。</p>

        <li>
            <h4>連番画像の何番が誰なのか？ 一覧する。</h4>
            <p>実は｢<a href="?page=nobu_face_list">武将一覧.xls</a>｣にこれをサポートする機能が実装されています。<br>

                ｢武将一覧.xls｣を｢kao_3bit｣フォルダに置き、武将一覧.xlsを立ち上げて｢顔｣ボタンを押すと<br>
                0001.bmp～ の画像をExcel上にインポートする機能が備わっています。<br>
                (kao_24bitフォルダに置けば、そちらが対象となります。とにかく連番の顔画像ファイルがあれば良いだけです) <br>
                (※Excelのマクロが有効でないと機能しないので、マクロを有効にして下さい。<br>
                マクロを有効にするやり方はネットで検索して調べて下さい)<br>
                <img src="./cnt_mod/cnt_face_bushouexcel.png"></p>

    </ul>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>拡張系Kaoswap**.N6Pへの対応状況</h3>
    <ul class="pointlist">
        <li>
            <h4>KaoswapEX.N6Pにも対応</h4>
            <p>このツールはKaoswapEX.n6pのファイルを発見すると、<br>
                Kaoswap.n6pに引き続き、KaoswapEX.n6pに対しても同様の処理を行います。<br>
                即ち、
                <ul>
                    <li>KaoswapEX.n6pを読み込んで、
                    <li>取り込むべき｢xxxx.bmp｣が存在すれば全て取り込み、
                    <li>KaoswapEX.n6pを書き換えます。
                </ul>
                この場合、「xxxx.bmp｣とは0001.bmp～1932.bmpまでが対象となります。<br>
            </p>
        <li>
            <h4>KaoswapUX.N6Pにも対応</h4>
            <p>KaoswapUX.N6Pにも対応しています。考え方や対応状況はKaoswapEx.N6Pと同じです。<br>
                この場合、「xxxx.bmp｣とは0001.bmp～2932.bmpまでが対象となります。</p>
        <li>
            <h4>KaoswapExMaker</b>との関係</h4>
            <p>・KaoswapExMakerは、Kaoswap.n6pの内容を引き継いで、KaoswapEX.n6pを作成するツールです。</p>
            <p>・KaoswapFaceImporeterは、あくまでも用意された顔画像の取り込みを自動化するツールです。</p>
    </ul>
</div>