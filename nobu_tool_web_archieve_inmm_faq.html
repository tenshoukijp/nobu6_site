%(hilight)s
<div class="content-box mb-3 content-lighten">
    <h1><i class="fa fa-book fa-fw"></i>_inmm.dll FAQ</h1>
    Last update: 2006/04/08
    <hr>
</div>
<div class="content-box mb-3 content-lighten">
    <h2>Contents</h2>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>インストール</h3>
    <ul>
        <li>
            <a href="#hidden">
                圧縮ファイルを展開しましたが、_inmm.dllというファイルが見当たりません。
            </a>
        </li>
        <li>
            <a href="#player">
                外部プレイヤーはどこにありますか？
            </a>
        </li>
        <li>
            <a href="#cdcheck">
                CDチェックを回避するには？
            </a>
        </li>
        <li>
            <a href="#_inmmserv">
                _inmmserv.exeってなんですか？
            </a>
        </li>
        <li>
            <a href="#trackfile">
                _inmm.iniに指定するMP3ファイルはどこにありますか？
            </a>
        </li>
    </ul>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>トラブル</h3>
    <ul>
        <li>
            <a href="#dllnotfound">
                「_inmm.dllが見つかりませんでした。」と表示されてゲームが起動できません。
            </a>
        </li>
        <li>
            <a href="#olddll">
                ゲームを起動すると「古いバージョンの_inmm.dllです」というメッセージが出ます。
            </a>
        </li>
        <li>
            <a href="#codec">
                「必要なコーデックがインストールされていない可能性があります。」というエラーが出ます。
            </a>
        </li>
        <li>
            <a href="#se">
                _inmm.dllを使うと、ゲーム中の効果音/音声が出なくなってしまいます。
            </a>
        </li>
        <li>
            <a href="#wavedev">
                「Waveデバイス使用中のため再生できません。」と言われて曲が鳴りません。
            </a>
        </li>
        <li>
            <a href="#bgm_ds">
                BGMをDirectSoundから出力するには？
            </a>
        </li>
        <li>
            <a href="#ds_exclusive">
                ゲームのウィンドウをアクティブにするとBGMが止まってしまいます。
            </a>
        </li>
        <li>
            <a href="#extfmt">
                実際と違う曲が再生されます。
            </a>
        </li>
        <li>
            <a href="#specialpatch">
                パッチを当てたのにCDから音が鳴ります。
            </a>
        </li>
        <li>
            <a href="#winamp_volume">
                再生にWinampを使っていると、音量が0になってしまうことがあります。
            </a>
        </li>
    </ul>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>その他</h3>
    <ul>
        <li>
            <a href="#volume">
                BGMのボリュームを変えるには？
            </a>
        </li>
        <li>
            <a href="#cuesheet">
                cueシート+音楽ファイル の形式を再生できますか？
            </a>
        </li>
        <li>
            <a href="#anotherplayer">
                ○○というプレイヤーに対応してほしいのですが…。
            </a>
        </li>
    </ul>
    <hr>
</div>
<div class="content-box mb-3 content-lighten">
    <h2>インストール</h2>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="hidden" href="#hidden">
            圧縮ファイルを展開しましたが、_inmm.dllというファイルが見当たりません。
        </a>
    </h3>
    <div class="answer">
        <p>
            エクスプローラが「システムファイルを表示しない」設定になっていませんか？<br>
            [表示] - [フォルダオプション]で、すべてのファイルを表示する設定にすると出てくると思います。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="player" href="#player">
            外部プレイヤーはどこにありますか？
        </a>
    </h3>
    <div class="answer">
        <dl>
            <dt>
                <strong>Winamp</strong>
                (<a href="http://www.winamp.com/">WINAMP.COM</a>)
            </dt>
            <dd>
                <p>
                    Nullsoftのフリーソフトで、代表的なMP3プレイヤーです。MP3以外の様々なサウンドフォーマットにも対応しています。
                </p>
            </dd>
            <dt>
                <strong>SCMPX</strong>
                (<a href="http://70.nu/ch3/">CH3's homepage</a>)
            </dt>
            <dd>
                <p>
                    ch3さん作の国産でフリーなMP3プレイヤーです。
                </p>
            </dd>
            <dt>
                <strong>Digital CD Player</strong>
                (<a href="http://homepage2.nifty.com/%E2%80%BEmaid/">みゃん☆みゃん☆ふぁくとりぃ☆</a>)
            </dt>
            <dd>
                <p>
                    もろぼし☆らむさん作のフリーなCDプレイヤーです。CDから直にデータを読み出してWAVEとして再生するので、アナログの音声コードがドライブと未接続でも再生できます。
                </p>
            </dd>
            <dt>
                <strong>Lilith</strong>
                (<a href="http://www.project9k.jp/">Project9k</a>)
            </dt>
            <dd>
                <p>
                    NVさん作の多機能・高速なサウンドプレイヤーです。
                </p>
            </dd>
        </dl>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="cdcheck" href="#cdcheck">
            CDチェックを回避するには？
        </a>
    </h3>
    <div class="answer">
        <p>
            「仮想CDユーテリティ」を使います。これは、HDD上のCD-ROMイメージファイルを、仮想的なCD-ROMドライブ（に入っているCD）のようにアクセス可能にするものです。ゲームのCDを仮想CD化することで、ゲームにCDが入っていると思わせることができます。
        </p>
        <p>
            代表的な仮想CDユーテリティには
        </p>
        <ul>
            <li>
                <strong>ＣＤ革命/Virtual</strong>
                (<a href="http://www.ark-info-sys.co.jp/">アーク情報システム</a>)
            <li>
                <strong>DAEMON Tools</strong>
                (<a href="https://www.daemon-tools.cc/jpn/products/dtLite#install-dtLite">https://www.daemon-tools.cc/jpn/products/dtLite#install-dtLite</a>)

        </ul>
        <p>
            などがあります。各ソフトの操作法は各々のマニュアルを参照してください。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="_inmmserv" href="#_inmmserv">
            _inmmserv.exeってなんですか？
        </a>
    </h3>
    <div class="answer">
        <p>
            バージョン2.30から、従来 _inmm.dll で行っていた処理の一部（外部プレイヤーの制御など）を、独立したプログラム _inmmserv.exe に移しました。
            _inmmserv.exe は _inmm.dll の裏方として働くプログラムで、_inmm.dll から起動されます。_inmm.dllを使ったプログラムが終了すると、_inmmserv.exe
            も終了します。
        </p>
        <p>ゲームが強制終了してしまった場合など、_inmmserv.exeが終了されずに残ってしまう場合は、タスクトレイの_inmmserv.exeのアイコンをクリックしてメニューから「終了」を選んでください。</p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="trackfile" href="#trackfile">
            _inmm.iniに指定するMP3ファイルはどこにありますか？
        </a>
    </h3>
    <div class="answer">
        <p>
            _inmm.dllは、本来CDのオーディオトラックから再生される音楽を、MP3などから鳴らせるようにするものです。_inmm.iniに指定するファイルは、自分でCD
            のオーディオトラックから吸い出す必要があります。これにはリッパーと呼ばれるソフトを使います。フリーのリッパーとしては、
            <a href="http://cdexos.sourceforge.net/">CDex</a>や<a href="http://homepage2.nifty.com/%E2%80%BEmaid/">CD2WAV</a>などがあります。
        </p>
    </div>
    <hr>
</div>
<div class="content-box mb-3 content-lighten">
    <h2>トラブル</h2>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="dllnotfound" href="#dllnotfound">
            「_inmm.dllが見つかりませんでした。」と表示されてゲームが起動できません。
        </a>
    </h3>
    <div class="answer">
        <p>
            _inmm.dllをwindowsフォルダかwindows\systemフォルダ（NT系ではwinntフォルダかwinnt\system32フォルダ）、またはゲームをインストールしたフォルダにコピーしてください。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="olddll" href="#olddll">
            ゲームを起動すると「古いバージョンの_inmm.dllです」というメッセージが出ます。
        </a>
    </h3>
    <div class="answer">
        <p>
            _inmmcnf.exeがレジストリに書き込んだバージョン番号より古いバージョンの
            _inmm.dllが読み込まれています。最新の_inmm.dllをwindowsのフォルダにコピーするのを忘れていませんか？
        </p>
        <p>
            また、WindowsはDLLファイルを
        </p>
        <ol>
            <li>ゲーム本体のEXEファイルのあるフォルダ</li>
            <li>カレントフォルダ(普通はゲームをインストールしたフォルダ)</li>
            <li>windows\systemフォルダ</li>
            <li>windowsフォルダ</li>
            <li>環境変数PATHのフォルダ</li>
        </ol>
        <p>
            の順に探しますので、古いバージョンの_inmm.dllが優先順位の高いフォルダに残っているとそちらが読み込まれてしまいます。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="codec" href="#codec">
            「必要なコーデックがインストールされていない可能性があります。」というエラーが出ます。
        </a>
    </h3>
    <div class="answer">
        <p>
            MCIを使ってファイルを再生するには、そのファイル形式に対応したコーデックがインストールされている必要があります。
        </p>
        <p>
            MP3-WAVE形式（MP3ファイルにRIFF/WAVEヘッダをつけたもの）のコーデックは、
            Win95/98には含まれていません。このコーデックは<a href="?page=nobu_tool_web_archieve_inmm_index">
                _inmm.dllのホームページ
            </a>でダウンロードできます。
        </p>
        <p>
            MP3形式をMP3-WAVEにコンバートするツールには、MISKY氏の
            <a href="http://www.venus.dti.ne.jp/%E2%80%BEkog/">mp3 Checker</a>
            などがあります。
        </p>
        <p>
            最新のWindows Media Playerをインストールすると、生のMP3を再生できるコーデックがインストールされるようです。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="se" href="#se">
            _inmm.dllを使うと、ゲーム中の効果音/音声が出なくなってしまいます。
        </a>
    </h3>
    <div class="answer">
        <p>
            waveデバイスを使う方法（つまりMIDIやCD-DA以外）で曲を再生している場合、曲の再生中はwaveデバイスが埋まっているので効果音/音声を鳴らせません。
        </p>
        <p>まず、お使いのサウンドボードに対応したWDM (Windows Driver Model)版のドライバがないか調べてください。WDMドライバはミキシングの機能をもっているので、waveの同時出力が可能になります。</p>
        <p>複数同時再生できないWAVEオーディオ出力デバイスを、複数音声の同時再生に対応させる<a href="http://www.wg7.com/polywave/">PolyWave</a>というドライバソフトウェアがあるそうです。CPUパワーに余裕のある方は試してみるといいかもしれません。</p>
        <p>同時出力が不可能な場合は、[その他]-[効果音]オプションをいじると多少マシになるかもしれません。</p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="wavedev" href="#wavedev">
            「Waveデバイス使用中のため再生できません。」と言われて曲が鳴りません。
        </a>
    </h3>
    <div class="answer">
        <p>
            これもwaveの複数同時出力をサポートしていない環境で起こるエラーです。ゲーム側がWave出力デバイスを占有しているため、waveやmp3などを出力できなくなっています。
        </p>
        <p>
            waveの同時出力ができれば、これは解決します。<a href="#se">
                前の質問
            </a>も参照してください。
        </p>
        <p>
            DirectSoundを使っているゲームの場合、曲もDirectSoundから鳴らすことで解決できます。<a href="#bgm_ds">こちら</a>を参照してください。
        </p>
        <p>
            プレイヤーが「DirectSoundを使えない」というような文句を言う場合、そのゲームはDirectSoundを使っていません。残念ながら、BGMと効果音のどちらかを諦めるしかありません。<br>
            設定の[その他]-[効果音]を[BGMを一時的に止めて鳴らす]にしてみてください。それでも駄目なら[鳴らさない]にしてみてください（効果音は鳴らなくなってしまいます）。
        </p>
        <p>
            上記の方法でうまくいかなかった場合は…すみません、諦めてください。
            (^^;
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="bgm_ds" href="#bgm_ds">
            BGMをDirectSoundから出力するには？
        </a>
    </h3>
    <div class="answer">
        <p>
            今のところ、DirectSoundからの出力に対応しているプレイヤーはWinamp、
            Digital CD Player、Lilithです。
        </p>
        <p>
            Winampの出力をDirectSoundにするには、メニューから[Options] -
            [Preferences]を選択します。[Winamp - Preferences]というウィンドウが出てきますので、左側の欄の[Plug-ins]以下の[Output]をクリックします。すると右側のリストにOutput plug-inの一覧が出てきますので、その中から
            [Nullsoft DirectSound plug-in]を選択して反転表示にしたあと、[Close]ボタンを押します。<br>

            _inmm.iniを拡張形式にして、[Settings]セクションに
            <code>WA_OutDll=out_ds.dll</code>と記述する方法もあります。
        </p>
        <p>
            これでWinampの設定は完了ですが、_inmmcnf.exeのほうにも設定が必要です。
            [プレイヤー] - [Winamp] - [Wave出力の空きをチェックしない]を有効にしてください。
        </p>

        <p>
            Digital CD Playerの出力をDirectSoundにするには、メニューから[オプション] - [CDデバイス設定] の [再生に関する設定] - [DirectSoundを使って出力する]を有効にしてください。
        </p>
        <p>
            こちらも、_inmmcnf.exe側の設定が必要です。[プレイヤー] - [Digital CD
            Player] - [Wave出力の空きをチェックしない]を有効にしてください。
        </p>

        <p>
            LilithはもともとDirectSoundから再生を行います。特別な設定は必要ありません。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="ds_exclusive" href="#ds_exclusive">
            ゲームのウィンドウをアクティブにするとBGMが止まってしまいます。
        </a>
    </h3>
    <div class="answer">
        <p>
            Winampで曲をDirectSoundから出力させていますね？<br>
            DirectSound対応ソフトの中には、自分がアクティブになっているときは他のソフトのDirectSound出力をカットしてしまうものがあります。こういったソフトでは、Waveデバイスからでないと曲が鳴りません。WinampのDirectSound
            plug-inを使わない設定にしてください。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="extfmt" href="#extfmt">
            実際と違う曲が再生されます。
        </a>
    </h3>
    <div class="answer">
        <p>
            そのゲーム、第1トラックから音楽が入っていませんか？標準形式の_inmm.iniでは、第2トラックから書いていくことになっています。第1トラックから始まるつもりで書いてしまうと、曲順がひとつずつずれて再生されます。
        </p>
        <p>
            第1トラックからの指定を行いたい場合、_inmm.iniを拡張形式にします。
            _inmm.iniの先頭に
        </p>
        <blockquote>
            <pre>[Tracks]</pre>
        </blockquote>
        <p>
            と書くだけでOKです。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="specialpatch" href="#specialpatch">
            パッチを当てたのにCDから音が鳴ります。
        </a>
    </h3>
    <div class="answer">
        <p>
            パッチを当てたのに、_inmm.iniに指定したファイルでなくCDから曲が鳴るという場合、次の2つの原因が考えられます。
        </p>
        <ol>
            <li>パッチを当てるファイルが違う。</li>
            <li>WINMM.DLL以外のAPIを使ってCDを再生している。</li>
        </ol>
        <p>
            1.の場合、パッチを当てた実行ファイルとは別のファイルがCDの再生を担当しています。そのファイルにもパッチを当てる必要があります。
        </p>
        <p>
            2.の場合は、<a href="?page=nobu_tool_web_archieve_inmm_index">_inmm.dllのホームページ</a>で配布している _svfw32.dll を使います。試しているゲームがこれに該当するか調べるには、<a href="http://www.vector.co.jp/soft/win95/prog/se174434.html">Dependency Viewer</a>でゲームの実行ファイルを開いてみてください。MSVFW32.dll の MCIWndCreateA
            というAPIが使われていたら、これに該当する可能性があります。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="winamp_volume" href="#winamp_volume">
            再生にWinampを使っていると、音量が0になってしまうことがあります。
        </a>
    </h3>
    <div class="answer">
        <p>
            WinampのwaveOutプラグインの音量はWindowsのWAVE音量と同期しているため、
            BGMがフェードアウトして再生停止すると、それ以降WAVEの音量が0になってしまいます。
        </p>
        <p>
            解決方法としては、Winampの設定で以下のどちらかにします。
            <ul>
                <li>DirectSoundプラグインを使う。</li>
                <li>
                    waveOutプラグインの音量設定で、[Reset to original value on stop]
                    あるいは [Alt. setting method (slow)]（日本語版ではそれぞれ[停止時に音量を元に戻す]、[Alt設定法（低速）]）にチェックを入れる。
                </li>
            </ul>
        </p>
    </div>
    <hr>
</div>
<div class="content-box mb-3 content-lighten">
    <h2>その他</h2>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="volume" href="#volume">
            BGMのボリュームを変えるには？
        </a>
    </h3>
    <div class="answer">
        <p>
            _inmmはプレイヤーを起動したときのボリューム値を基準にします。BGMのボリュームを変えるには、あらかじめプレイヤーのボリューム値（MCIの場合は
            Windowsのボリュームコントロール）を調整してからゲームを始めてください。
        </p>
        <p>
            Winampの waveOut plug-in やSCMPXのボリュームはWindowsのWaveボリュームと同期しています。BGMと効果音・音声のボリュームのバランスを調整するには、WinampのpreampまたはSCMPXのイコライザを使ってください。
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="cuesheet" href="#cuesheet">
            cueシート+音楽ファイル の形式を再生できますか？
        </a>
    </h3>
    <div class="answer">
        <p>
            MCI, DirectShow, Lilithでは、「プレイリスト+リスト内番号」形式で
            _inmm.iniを記述することで、cueシート+音楽ファイル形式を再生できます。例えば、
        </p>
        <blockquote>
            <pre>c:\hoge.cue:2</pre>
        </blockquote>
        <p>
            と書くと、hoge.cueのトラック2部分が再生されます。_inmmcnf の
            _inmm.ini簡易エディタにcueシートをドラッグ&amp;ドロップすると、この形式の_inmm.iniを簡単に作成できます。
        </p>
        <p>
            MCIとDirectShowでは、音楽ファイルに対応するコーデックやDirectShowフィルタがインストールされていることが必要です。またコーデックやDirectShow
            フィルタが可変ビットレート(VBR)でエンコードされたファイルのシークに正しく対応していない場合、再生位置がおかしくなる場合があります。
        </p>
        <p>
            WinampではCUE Player (in_cue.dll)を導入することでcueシート+音楽ファイルを利用できます。この場合、以下のような_inmm.iniを使います。
        </p>
        <blockquote>
            <pre>[Tracks]

c:\cue\hoge.cue,2
c:\cue\hoge.cue,3
c:\cue\hoge.cue,4

[Players]
Winamp=*.cue,*

[Settings]
SkipFileCheck=1</pre>
        </blockquote>
        <p>
            この方法は、サポート掲示板の[1358]で埴輪さんに教えてもらいました。感謝！
        </p>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>
        <a name="anotherplayer" href="#anotherplayer">
            ○○というプレイヤーに対応してほしいのですが…。
        </a>
    </h3>
    <div class="answer">
        <p>
            現在 _inmm が対応している方式では再生できないファイル形式を使いたい場合、サポート掲示板に書き込んでください。ただし、プレイヤーの追加はよほどの理由がない限り、しない方針です。外部のプレイヤーを操作する方法ではどうしても細かい制御がしにくいので、できるだけ外部のプレイヤーに頼らない方向で進めていきたいと考えています。
        </p>
    </div>
</div>